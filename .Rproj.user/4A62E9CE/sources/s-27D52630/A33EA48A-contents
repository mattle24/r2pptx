library(ggplot2)
my_plot <- ggplot(mtcars, aes(x = mpg, y = cyl)) +
  geom_point()
x <- new_element("Google Shape;18;p4", my_plot)
title_element <- new_element("Google Shape;17;p4", "A new tomorrow, today")
plot_element <- new_element("Google Shape;18;p4", my_plot)

slide <- new_slide(layout = "TITLE_AND_BODY")
slide <- slide + 
  plot_element +
  title_element

template_path <- "~/Downloads/Untitled presentation.pptx"
presentation <- new_presentation("My Presentation", template_path)
presentation <- presentation + slide

inherits(presentation@slides, "R2PptxSlide")
template_path(presentation) <- "x"
# path <- tempfile(fileext = ".pptx")
path <- tempfile(fileext = ".pptx")
write_pptx(presentation, path)
system(paste("open", path))


# list of slides

slide_function <- function(...) {
  dat <- data.frame(x = runif(50), y = rnorm(50))
  plot <- ggplot(dat, aes(x = x, y = y)) +
    geom_point()
  plot_element <- new_element("Google Shape;18;p4", plot)
  title_element <- new_element("Google Shape;17;p4", "A title")
  new_slide(plot_element, title_element, layout = "TITLE_AND_BODY")
}

slide_list <- purrr::map(1:20, slide_function)
presentation <- new_presentation("My Presentation")
purrr::reduce(slide_list, `+`)
